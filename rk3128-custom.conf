# ============================================
# RK3128 打印机服务器配置 (适配 current 内核)
# ============================================

# --- 板型与家族 ---
BOARD="rock64"
BOARD_NAME="RK3128 Printer Server"
BOARDFAMILY="rockchip"
LINUXFAMILY="rockchip"

# --- 内核与版本 ---
BRANCH="current"               # 必须使用 current 分支
KERNEL_TARGET="current"
RELEASE="jammy"                # Ubuntu 22.04 LTS
ARCH="armhf"

# --- 硬件适配 (RK3128 专用) ---
BOOTCONFIG="rockchip_rk3128_defconfig"
KERNEL_IMAGE_TYPE="Image"
BOOT_SOC="rk3128"
BOOT_FDT_FILE="rockchip/rk3128-echo.dtb"
SERIALCON="ttyS2,1500000"

# --- 系统构建选项 ---
BUILD_MINIMAL="yes"
BUILD_DESKTOP="no"
BSPFREEZE="yes"
INSTALL_KERNEL="yes"
KERNEL_CONFIGURE="yes"        # 允许我们覆盖内核配置
COMPRESS_OUTPUTIMAGE="sha,gz,img"
IMAGE_PARTITION_TABLE="msdos"
BOOTFS_TYPE="fat"
ROOTFS_TYPE="ext4"
BOOTSIZE="256"                # 稍大一点确保启动正常
EXPERT="yes"
FORCE_BOOTSCRIPT_UPDATE="yes"

# --- 打印机服务器软件包 ---
PACKAGE_LIST_BASE="firmware-linux-free"
PACKAGE_LIST_ADDITIONAL="cups cups-client cups-filters cups-bsd cups-pdf printer-driver-all hplip sane sane-utils avahi-daemon avahi-discover network-manager usbutils"

# --- 网络配置 ---
NETWORK="network-manager"
NETWORKMANAGER="no"
WIREGUARD="no"
EXTRAWIFI="no"
EXTERNAL="no"

# --- 强制使用较旧但兼容的组件 ---
# 这些设置有助于避免新版内核的兼容性问题
UBOOT_USE_GCC='> 7.0'
ATF_USE_GCC='> 9.0'
KERNEL_USE_GCC='> 9.0'
